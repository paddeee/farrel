<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="epe-pdf-viewer">
  <style>

    :host {
      display: block;
    }

    .pdf__footer {
      background: rgb(55, 64, 70);
      color: var(--text-primary-color);
      padding: 8px;
      font-size: 2vh;
      height: 5vh;
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
    }

    .pdf_name {
      margin-right: 2vw;
    }

    .pdf_current-page {
      font-size: 3vh;
      margin-right: 2px;
    }

  </style>
  <link rel="stylesheet" href="../../styles/vendor/pdf/pdf.css">
  <script src="../../scripts/vendor/pdf/l10n.js"></script>
  <script src="../../scripts/vendor/pdf/pdf.js"></script>
  <script src="../../scripts/vendor/pdf/pdf-viewer.js"></script>

  <template>

    <!-- Loading Bar ToDo: Use Polymer loading bar  -->
    <div id="loadingBar">
      <div class="progress">
        <div class="glimmer">
        </div>
      </div>
    </div>

    <div class="pdf layout horizontal">

      <!-- ToDo: Sidebar - Can turn on at later date by removing hidden and sorting toggle functionality for it -->
      <div id="sidebarContainer" hidden>
        <div id="toolbarSidebar">
          <div class="splitToolbarButton toggled">
            <button id="viewThumbnail" class="toolbarButton group toggled" title="Show Thumbnails" tabindex="2" data-l10n-id="thumbs">
              <span data-l10n-id="thumbs_label">Thumbnails</span>
            </button>
            <button id="viewOutline" class="toolbarButton group" title="Show Document Outline" tabindex="3" data-l10n-id="outline">
              <span data-l10n-id="outline_label">Document Outline</span>
            </button>
            <button id="viewAttachments" class="toolbarButton group" title="Show Attachments" tabindex="4" data-l10n-id="attachments">
              <span data-l10n-id="attachments_label">Attachments</span>
            </button>
          </div>
        </div>
        <div id="sidebarContent">
          <div id="thumbnailView">
          </div>
          <div id="outlineView" class="hidden">
          </div>
          <div id="attachmentsView" class="hidden">
          </div>
        </div>
      </div>

      <!-- Main Area -->
      <div class="pdf -viewer layout vertical">

        <!-- Viewer -->
        <div id="viewerContainer" class="pdf__canvas flex" tabindex="0">
          <div id="viewer" class="pdfViewer"></div>
        </div>

        <!-- Footer -->
        <div class="pdf__footer horizontal layout center">
          <div class="pdf_name">
            <span>[[pdfName]]</span>
          </div>
          <div class="pdf_button-holder flex">
            <paper-icon-button id="sidebarToggle" tabindex="11" icon="toggle"></paper-icon-button>
            <paper-icon-button icon="search"></paper-icon-button>
            <paper-icon-button id="previous" icon="arrow-back"></paper-icon-button>
            <paper-icon-button id="next" icon="arrow-forward"></paper-icon-button>
            <paper-icon-button id="zoomIn" icon="zoom-in"></paper-icon-button>
            <paper-icon-button id="zoomOut" icon="zoom-out"></paper-icon-button>

            <!-- ToDo: Can remove hide when ready to work on this -->
            <span id="scaleSelectContainer" class="dropdownToolbarButton" hidden>
              <select id="scaleSelect" title="Zoom" tabindex="23" data-l10n-id="zoom">
               <option id="pageAutoOption" title="" value="auto" selected="selected" data-l10n-id="page_scale_auto">Automatic Zoom</option>
               <option id="pageActualOption" title="" value="page-actual" data-l10n-id="page_scale_actual">Actual Size</option>
               <option id="pageFitOption" title="" value="page-fit" data-l10n-id="page_scale_fit">Fit Page</option>
               <option id="pageWidthOption" title="" value="page-width" data-l10n-id="page_scale_width">Full Width</option>
               <option id="customScaleOption" title="" value="custom"></option>
               <option title="" value="0.5" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 50 }'>50%</option>
               <option title="" value="0.75" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 75 }'>75%</option>
               <option title="" value="1" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 100 }'>100%</option>
               <option title="" value="1.25" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 125 }'>125%</option>
               <option title="" value="1.5" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 150 }'>150%</option>
               <option title="" value="2" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 200 }'>200%</option>
               <option title="" value="3" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 300 }'>300%</option>
               <option title="" value="4" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 400 }'>400%</option>
              </select>
            </span>
          </div>
          <div class="pdf_page-info flex">
            <span id="pageNumber" class="pdf_current-page">[[page]]</span>/<span id="numPages" class="pdf_total-pages">[[totalPages]]</span>
          </div>
        </div>
      </div>

      <!-- ToDo: Just putting this in as not sure if needed later -->
      <div id="errorWrapper" class="error-wrapper" hidden>
        <div id="errorMessageLeft">
          <span id="errorMessage"></span>
          <button id="errorShowMore" data-l10n-id="error_more_info">
            More Information
          </button>
          <button id="errorShowLess" data-l10n-id="error_less_info" hidden='true'>
            Less Information
          </button>
        </div>
        <div id="errorMessageRight">
          <button id="errorClose" data-l10n-id="error_close">
            Close
          </button>
        </div>
        <div class="clearBoth"></div>
        <textarea id="errorMoreInfo" hidden='true' readonly="readonly"></textarea>
      </div>
    </div>

    </div>
  </template>
</dom-module>
<script>
(function() {
  Polymer({
    is: 'epe-pdf-viewer',

    properties: {

      pdfObject: {
        type: Object,
        value: null,
        observer: 'pdfObjectChanged'
      }
    },

    // CALLED FROM OBSERVER ON PDFOBJECT
    pdfObjectChanged: function() {

      if (this.pdfObject) {

        if (!PDFViewerApplication.initialized) {
          webViewerLoad();
        }
      }
    }
  });
})();
</script>
